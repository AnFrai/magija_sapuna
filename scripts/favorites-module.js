var S={showMessage:c=>{let o=c.closest(".catalog__card").querySelector(".catalog__card-message"),n=o.querySelector(".catalog__card-message-text");n.classList.add("catalog__card-message-text--added"),setTimeout(()=>{n.classList.remove("catalog__card-message-text--added")},500),o.classList.contains("catalog__card-message--animate")?(clearTimeout(o.timeoutId),o.timeoutId=setTimeout(()=>{o.classList.remove("catalog__card-message--animate")},4e3)):(o.classList.add("catalog__card-message--animate"),o.timeoutId=setTimeout(()=>{o.classList.remove("catalog__card-message--animate")},4e3))}};function _(r,c,o){let n="";if(o){let s=new Date;s.setTime(s.getTime()+o*24*60*60*1e3),n=`; expires=${s.toUTCString()}`}document.cookie=`${r}=${c||""}${n}; path=/; SameSite=None; Secure`}function m(r){let c=`${r}=`,o=document.cookie.split(";");for(let n=0;n<o.length;n++){let s=o[n];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(c)===0)return s.substring(c.length,s.length)}return null}var C=(()=>{let r=document.querySelector(".user-communication__button--cart"),c=document.querySelector(".user-communication__button-counter--cart"),o=parseInt(m("cartItemCount"),10)||0,n=()=>{o>0?(r.classList.add("icon-button--user-communication-cart-added"),c.classList.remove("visually-hidden"),c.textContent=o,r.title=`Artikala u korpi: ${o}`):(r.classList.remove("icon-button--user-communication-cart-added"),c.classList.add("visually-hidden"),r.title="Nema artikala u korpi"),_("cartItemCount",o,7)},s=i=>{let t=i.dataset.productId;i.classList.add("catalog__card-button--added-to-cart"),i.classList.remove("catalog__card-button--add-to-cart"),_(`product_${t}_added`,"true",7);let e=parseInt(m(`product_${t}_count`),10)||0;e+=1,_(`product_${t}_count`,e,7);let a=i.querySelector(".catalog__card-button-counter--cart");a.textContent=e;let d=document.querySelector(`#favoriteList [data-product-id="${t}"]`);if(d){let u=d.querySelector(".cart-button");u.classList.add("catalog__card-button--added-to-cart"),u.classList.remove("catalog__card-button--add-to-cart");let p=u.querySelector(".catalog__card-button-counter--cart");p.textContent=e}let l=document.querySelector(`.catalog__list [data-product-id="${t}"]`);if(l){let u=l.querySelector(".cart-button");u.classList.add("catalog__card-button--added-to-cart"),u.classList.remove("catalog__card-button--add-to-cart");let p=u.querySelector(".catalog__card-button-counter--cart");p.textContent=e}o++,n(),S.showMessage(i)},v=()=>{document.querySelectorAll(".cart-button").forEach(t=>{t.addEventListener("click",()=>s(t))})},f=(i,t)=>{m(`product_${t}_added`)==="true"&&(i.classList.add("catalog__card-button--added-to-cart"),i.classList.remove("catalog__card-button--add-to-cart"))};return{init:()=>{v(),o=parseInt(m("cartItemCount"),10)||0,n(),document.querySelectorAll(".cart-button").forEach(t=>{let e=t.dataset.productId,a=parseInt(m(`product_${e}_count`),10)||0,d=t.querySelector(".catalog__card-button-counter--cart");d.textContent=a,f(t,e)})},handleCartAddition:s}})();function g(){let r=document.getElementById("favoriteList"),c=document.querySelector(".no-articles");r&&c&&(r.children.length>0?c.classList.add("visually-hidden"):c.classList.remove("visually-hidden"))}var B=(()=>{let r=()=>JSON.parse(localStorage.getItem("favorites"))||[],c=t=>{localStorage.setItem("favorites",JSON.stringify(t))},o=t=>{let e=r();e=e.filter(l=>l!==t),c(e);let a=document.querySelector(`#favoriteList [data-product-id="${t}"]`);a&&a.remove();let d=document.querySelector(`.catalog__list [data-product-id="${t}"] .favorite-button`);d&&(d.classList.remove("catalog__card-button--favorite-added"),d.classList.add("catalog__card-button--favorite-add")),g()},n=(t,e)=>{let a=document.getElementById("favoriteList"),d=e.cloneNode(!0),l=d.querySelector(".favorite-button");l.classList.remove("catalog__card-button--favorite-add"),l.classList.add("catalog__card-button--favorite-added"),l.addEventListener("click",()=>o(t));let u=d.querySelector(".cart-button");u.addEventListener("click",()=>C.handleCartAddition(u)),a.appendChild(d),g()},s=(t,e)=>{let a=r();a.includes(t)||(a.push(t),c(a),n(t,e))},v=t=>{let e=t.closest(".catalog__card"),a=e.querySelector(".cart-button").dataset.productId;t.classList.contains("catalog__card-button--favorite-added")?o(a):(s(a,e),t.classList.remove("catalog__card-button--favorite-add"),t.classList.add("catalog__card-button--favorite-added"))},f=()=>{document.querySelectorAll(".favorite-button").forEach(e=>{e.addEventListener("click",()=>v(e))})},L=()=>{r().forEach(e=>{let a=document.querySelector(`[data-product-id="${e}"]`);a&&(a.querySelector(".favorite-button").classList.remove("catalog__card-button--favorite-add"),a.querySelector(".favorite-button").classList.add("catalog__card-button--favorite-added"),n(e,a))}),g()};return{init:()=>{f(),L()}}})();export{B as favoritesModule};
