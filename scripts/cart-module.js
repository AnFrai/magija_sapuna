var p={showMessage:c=>{let t=c.closest(".catalog__card").querySelector(".catalog__card-message"),o=t.querySelector(".catalog__card-message-text");o.classList.add("catalog__card-message-text--added"),setTimeout(()=>{o.classList.remove("catalog__card-message-text--added")},500),t.classList.contains("catalog__card-message--animate")?(clearTimeout(t.timeoutId),t.timeoutId=setTimeout(()=>{t.classList.remove("catalog__card-message--animate")},4e3)):(t.classList.add("catalog__card-message--animate"),t.timeoutId=setTimeout(()=>{t.classList.remove("catalog__card-message--animate")},4e3))}};function l(s,c,t){let o="";if(t){let e=new Date;e.setTime(e.getTime()+t*24*60*60*1e3),o=`; expires=${e.toUTCString()}`}document.cookie=`${s}=${c||""}${o}; path=/; SameSite=None; Secure`}function i(s){let c=`${s}=`,t=document.cookie.split(";");for(let o=0;o<t.length;o++){let e=t[o];for(;e.charAt(0)===" ";)e=e.substring(1,e.length);if(e.indexOf(c)===0)return e.substring(c.length,e.length)}return null}var I=(()=>{let s=document.querySelector(".user-communication__button--cart"),c=document.querySelector(".user-communication__button-counter--cart"),t=parseInt(i("cartItemCount"),10)||0,o=()=>{t>0?(s.classList.add("icon-button--user-communication-cart-added"),c.classList.remove("visually-hidden"),c.textContent=t,s.title=`Artikala u korpi: ${t}`):(s.classList.remove("icon-button--user-communication-cart-added"),c.classList.add("visually-hidden"),s.title="Nema artikala u korpi"),l("cartItemCount",t,7)},e=r=>{let a=r.dataset.productId;r.classList.add("catalog__card-button--added-to-cart"),r.classList.remove("catalog__card-button--add-to-cart"),l(`product_${a}_added`,"true",7);let n=parseInt(i(`product_${a}_count`),10)||0;n+=1,l(`product_${a}_count`,n,7);let m=r.querySelector(".catalog__card-button-counter--cart");m.textContent=n;let u=document.querySelector(`#favoriteList [data-product-id="${a}"]`);if(u){let d=u.querySelector(".cart-button");d.classList.add("catalog__card-button--added-to-cart"),d.classList.remove("catalog__card-button--add-to-cart");let _=d.querySelector(".catalog__card-button-counter--cart");_.textContent=n}let g=document.querySelector(`.catalog__list [data-product-id="${a}"]`);if(g){let d=g.querySelector(".cart-button");d.classList.add("catalog__card-button--added-to-cart"),d.classList.remove("catalog__card-button--add-to-cart");let _=d.querySelector(".catalog__card-button-counter--cart");_.textContent=n}t++,o(),p.showMessage(r)},C=()=>{document.querySelectorAll(".cart-button").forEach(a=>{a.addEventListener("click",()=>e(a))})},S=(r,a)=>{i(`product_${a}_added`)==="true"&&(r.classList.add("catalog__card-button--added-to-cart"),r.classList.remove("catalog__card-button--add-to-cart"))};return{init:()=>{C(),t=parseInt(i("cartItemCount"),10)||0,o(),document.querySelectorAll(".cart-button").forEach(a=>{let n=a.dataset.productId,m=parseInt(i(`product_${n}_count`),10)||0,u=a.querySelector(".catalog__card-button-counter--cart");u.textContent=m,S(a,n)})},handleCartAddition:e}})();export{I as cartModule};
